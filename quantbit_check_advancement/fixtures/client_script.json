[
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Payment Entry",
  "enabled": 1,
  "modified": "2024-06-14 13:33:00.217643",
  "module": "Quantbit Check Advancement",
  "name": "Digital Cheque Book Filter",
  "script": "frappe.ui.form.on(\"Payment Entry\", {\n    setup: function(frm) {\n        frm.set_query(\"custom_chequebook_number_details\", function() { // Replace with the name of the link field payment_status\n            return {\n                filters: [\n                    [\"Chequebook Number details\", \"parent_document\", '=', frm.doc.paid_from], // Replace with your actual filter criteria before_cancel\n                    [\"Chequebook Number details\", \"payment_status\", '=', 0],\n                    [\"Chequebook Number details\", \"active_status\", '=', 1],\n                ]\n            };\n        });\n    },\n\n    custom_chequebook_number_details: function(frm) {\n        if (frm.doc.custom_chequebook_number_details) {\n            frappe.call({\n                method: \"frappe.client.get_value\",\n                args: {\n                    doctype: \"Chequebook Number details\",\n                    filters: {\n                        name: frm.doc.custom_chequebook_number_details\n                    },\n                    fieldname: \"cheque_number\"\n                },\n                callback: function(r) {\n                    if (r.message) {\n                        frm.set_value(\"reference_no\", r.message.cheque_number);\n                    }\n                }\n            });\n        }\n    } ,\n\n\n    before_submit: function(frm) {\n        if (frm.doc.paid_from && frm.doc.reference_no) {\n            frappe.call({\n                method: \"frappe.client.get_value\",\n                args: {\n                    doctype: \"Chequebook Number details\",\n                    filters: {\n                        parent_document: frm.doc.paid_from,\n                        cheque_number: parseInt(frm.doc.reference_no)\n                    },\n                    fieldname: \"name\"\n                },\n                callback: function(r) {\n                    if (r.message) {\n                        // frappe.model.set_value(\"Chequebook Number details\", r.message.name, \"payment_status\", 1);\n                        frappe.call({\n                            method: \"frappe.client.set_value\",\n                            args: {\n                                doctype: \"Chequebook Number details\",\n                                name: r.message.name,\n                                fieldname: \"payment_status\",\n                                value: 1\n                            },\n                            callback: function(response) {\n                                // Handle callback response if needed\n                            }\n                        });\n                    }\n                }\n            });\n        }\n    },\n\n    before_cancel: function(frm) {\n        if (frm.doc.paid_from && frm.doc.reference_no) {\n            frappe.call({\n                method: \"frappe.client.get_value\",\n                args: {\n                    doctype: \"Chequebook Number details\",\n                    filters: {\n                        parent_document: frm.doc.paid_from,\n                        cheque_number: parseInt(frm.doc.reference_no)\n                    },\n                    fieldname: \"name\"\n                },\n                callback: function(r) {\n                    if (r.message) {\n                        frappe.call({\n                            method: \"frappe.client.set_value\",\n                            args: {\n                                doctype: \"Chequebook Number details\",\n                                name: r.message.name,\n                                fieldname: \"payment_status\",\n                                value: 0\n                            },\n                            callback: function(response) {}\n                        });\n                    }\n                }\n            });\n        }\n    },\n\n});",
  "view": "Form"
 }
]